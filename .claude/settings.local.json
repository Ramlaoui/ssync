{
  "permissions": {
    "allow": [
      "Bash(python3:*)",
      "Bash(timeout:*)",
      "Bash(ssync:*)",
      "Bash(sqlite3:*)",
      "Bash(ssh:*)",
      "Bash(chmod:*)",
      "Bash(curl:*)",
      "Bash(journalctl:*)",
      "Bash(echo:*)",
      "Bash(npm run build:*)",
      "Bash(python -m pytest tests/ -xvs -k \"test_\")",
      "Read(//tmp/**)",
      "Bash(pkill:*)",
      "Bash(npm run check:*)",
      "Bash(python:*)",
      "Bash(uv pip install:*)",
      "Bash(mv:*)",
      "Bash(npm install:*)",
      "Bash(npm run test:*)",
      "Bash(npm test:*)",
      "mcp__svelte__list-sections",
      "mcp__svelte__svelte-autofixer",
      "mcp__svelte__get-documentation",
      "Bash(npm view:*)",
      "Bash(npx sv migrate:*)",
      "WebFetch(domain:svelte.dev)",
      "Read(///**)",
      "Bash(npm run dev:*)",
      "Bash(git --no-pager diff --no-color src/)",
      "Bash(git --no-pager diff --no-color src/ssync/cache.py)",
      "Bash(git checkout:*)",
      "Bash(git add:*)",
      "Bash(gh pr create --title \"feat: Add comprehensive array job support and backend improvements\" --body \"$(cat <<''EOF''\n## Summary\n\nThis PR introduces comprehensive array job support and various backend improvements for better performance, reliability, and user experience.\n\n### Key Features\n\n#### ðŸŽ¯ Array Job Support\n- **Efficient Metadata Tracking**: New `array_jobs` and `array_task_stats` cache tables for fast queries\n- **Smart Filtering**: Automatically filter out misleading SLURM parent entries in CLI display\n- **Task Statistics**: Real-time state counting across array tasks\n- **API Integration**: Full array job support in web API with proper serialization\n\n#### âš¡ Performance Improvements\n- **Faster Failure Detection**: Reduced SSH connection timeouts from 15-20s to 5s\n- **Optimized Queries**: Indexed array job lookups for sub-millisecond retrieval\n- **Better Caching**: Integrated array metadata into cache middleware\n\n#### ðŸ”§ Watcher System Enhancements\n- **Static Watchers**: New `STATIC` state for manual-trigger-only watchers\n- **Enhanced Actions**: Improved variable capture and event logging\n- **Better Error Handling**: More resilient action execution\n\n#### ðŸ›¡ï¸ Reliability & Safety\n- **Migration-Safe**: All schema changes use `IF NOT EXISTS` and try/except\n- **Backward Compatible**: Existing data preserved during upgrades\n- **Enhanced Validation**: Better input sanitization for array job parameters\n\n### Technical Details\n\n**Database Schema Changes**\n```sql\n-- New tables for array job metadata\nCREATE TABLE array_jobs (...)\nCREATE TABLE array_task_stats (...)\n\n-- New column for faster filtering\nALTER TABLE cached_jobs ADD COLUMN array_job_id TEXT\n```\n\n**API Changes**\n- Added `array_job_id` and `array_task_id` to JobInfo model\n- New endpoints for array job metadata retrieval\n- Enhanced WebSocket support for array job updates\n\n**CLI Improvements**\n- Array parent entries (e.g., `443214_[2-3%4]`) are now filtered when individual tasks exist\n- Previously showed misleading states (only remaining tasks), now shows actual task states\n\n### Files Changed\n- `src/ssync/cache.py` (+310 lines): Array job metadata tracking\n- `src/ssync/web/app.py` (+629 lines): Enhanced API endpoints\n- `src/ssync/cli/display.py` (+51 lines): Smart array job filtering\n- `src/ssync/web/cache_middleware.py` (+119 lines): Integrated array metadata\n- `src/ssync/slurm/client.py` (+109 lines): Improved array job handling\n- Plus improvements across connection management, security, and parsers\n\n### Testing Notes\n- All migrations are backward compatible\n- Existing functionality preserved\n- Array job filtering tested with production SLURM data\n- Connection timeout improvements validated on unreachable hosts\n\n### Migration Guide\nNo action required - schema migrations run automatically on first startup.\n\n---\n\nðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)\nEOF\n)\" --base main)",
      "Bash(git commit:*)",
      "Bash(git push:*)",
      "Bash(gh pr create:*)",
      "Bash(cat:*)",
      "Bash(git reset:*)",
      "Bash(tree:*)",
      "Bash(git log:*)",
      "Bash(git merge-base:*)",
      "Bash(git merge:*)",
      "Bash(git pull:*)",
      "Bash(git stash:*)",
      "Bash(git rm:*)",
      "Bash(rm:*)",
      "Bash(source:*)",
      "Bash(pytest:*)",
      "Bash(tee:*)",
      "Bash(find:*)",
      "Bash(uv run pytest:*)",
      "Bash(npm run test:run:*)",
      "Bash(git --no-pager diff --no-color --stat)",
      "Bash(git --no-pager diff --no-color src/ssync/cache.py tests/)",
      "Bash(git --no-pager diff:*)"
    ],
    "deny": [],
    "ask": [],
    "additionalDirectories": [
      "/home/aliramlaoui"
    ]
  }
}
